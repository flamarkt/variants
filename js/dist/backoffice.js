(()=>{var t={n:a=>{var e=a&&a.__esModule?()=>a.default:()=>a;return t.d(e,{a:e}),e},d:(a,e)=>{for(var r in e)t.o(e,r)&&!t.o(a,r)&&Object.defineProperty(a,r,{enumerable:!0,get:e[r]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},a={};(()=>{"use strict";t.r(a),t.d(a,{backoffice:()=>V});const e=((flarum.extensions["flamarkt-core"]||{}).backoffice||{})["components/ProductList"];var r=t.n(e);const o=((flarum.extensions["flamarkt-core"]||{}).backoffice||{})["pages/ProductShowPage"];var n=t.n(o);const i=((flarum.extensions["flamarkt-core"]||{}).common||{})["models/Product"];var c=t.n(i);const s=((flarum.extensions["flamarkt-core"]||{}).common||{})["states/ProductListState"];var d=t.n(s);const u=flarum.core.compat["common/extend"],p=flarum.core.compat["common/Model"];var l=t.n(p);const f=flarum.core.compat["common/components/Button"];var h=t.n(f);const v=flarum.core.compat["common/components/LinkButton"];var y=t.n(v);const b=flarum.core.compat["common/components/Switch"];var M=t.n(b);function P(t,a){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,a){return t.__proto__=a,t},P(t,a)}const g=((flarum.extensions["flamarkt-backoffice"]||{}).backoffice||{})["components/AbstractList"];var k=function(t){var a,e;function r(){return t.apply(this,arguments)||this}e=t,(a=r).prototype=Object.create(e.prototype),a.prototype.constructor=a,P(a,e);var o=r.prototype;return o.head=function(){var a=t.prototype.head.call(this);return a.add("title",m("th","Title"),20),a.add("price",m("th","Price"),10),a},o.columns=function(a){var e=t.prototype.columns.call(this,a);return e.add("title",m("td",m("input.FormControl",{type:"text",value:a.title(),readonly:!0})),20),e.add("price",m("td",m("input.FormControl",{type:"number",value:a.price(),readonly:!0})),10),e},o.actions=function(a){var e=t.prototype.actions.call(this,a);return e.add("edit",y().component({className:"Button Button--icon",icon:"fas fa-pen",href:app.route.product(a)})),e},r}(t.n(g)()),V={"components/ProductVariantList":k};app.initializers.add("flamarkt-variants",(function(){c().prototype.variantMaster=l().hasOne("variantMaster"),(0,u.extend)(r().prototype,"head",(function(t){t.add("balance",m("th","Variants"))})),(0,u.extend)(r().prototype,"columns",(function(t,a){t.add("balance",m("td",a.attribute("isVariantMaster")?"Yes":"No"))})),(0,u.extend)(n().prototype,"oninit",(function(){this.variantChildrenAttached=!0})),(0,u.extend)(n().prototype,"show",(function(){this.isVariantMaster=this.product.attribute("isVariantMaster"),this.variantProductListState=new(d())({filter:{variantOf:this.product.id()}}),this.product.attribute("isVariantMaster")&&this.variantProductListState.refresh()})),(0,u.extend)(n().prototype,"fields",(function(t){var a=this;if(this.product.attribute("isVariantChild")){var e=this.product.variantMaster();t.add("variant-child-toggle",m(".Form-group",[m("label","Variant Child"),M().component({state:this.variantChildrenAttached,onchange:function(t){a.variantChildrenAttached=t,a.dirty=!0}},"Attached as child"),e?y().component({className:"Button",href:app.route.product(e)},"Edit Master"):null]))}else t.add("variant-master-toggle",m(".Form-group",[m("label","Variant Master"),M().component({state:this.isVariantMaster,onchange:function(t){a.isVariantMaster=t,a.dirty=!0}},"Make into master")]));this.product.attribute("isVariantMaster")&&t.add("variants",m(".Form-group",[m("label","Variants"),m(k,{state:this.variantProductListState}),h().component({onclick:function(){app.store.createRecord("flamarkt-products").save({relationships:{variantMaster:a.product}}).then((function(t){a.variantProductListState.add(t),m.redraw()}))}},"Add"),h().component({onclick:function(){a.variantProductListState.refresh()}},"Refresh")]),-10)})),(0,u.extend)(n().prototype,"data",(function(t){t.isVariantMaster=this.isVariantMaster,this.variantChildrenAttached||(t.relationships=t.relationships||{},t.relationships.variantMaster=null)}))}))})(),module.exports=a})();
//# sourceMappingURL=backoffice.js.map