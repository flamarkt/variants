(()=>{var t={n:a=>{var e=a&&a.__esModule?()=>a.default:()=>a;return t.d(e,{a:e}),e},d:(a,e)=>{for(var r in e)t.o(e,r)&&!t.o(a,r)&&Object.defineProperty(a,r,{enumerable:!0,get:e[r]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},a={};(()=>{"use strict";t.r(a),t.d(a,{backoffice:()=>L});const e=((flarum.extensions["flamarkt-backoffice"]||{}).backoffice||{}).app;var r=t.n(e);const n=((flarum.extensions["flamarkt-core"]||{}).backoffice||{})["components/ProductList"];var i=t.n(n);const o=((flarum.extensions["flamarkt-core"]||{}).backoffice||{})["pages/ProductIndexPage"];var s=t.n(o);const c=((flarum.extensions["flamarkt-core"]||{}).backoffice||{})["pages/ProductShowPage"];var l=t.n(c);const d=((flarum.extensions["flamarkt-core"]||{}).common||{})["models/Product"];var p=t.n(d);const u=((flarum.extensions["flamarkt-core"]||{}).common||{})["states/ProductListState"];var f=t.n(u);const h=flarum.core.compat["common/extend"],v=flarum.core.compat["common/Model"];var y=t.n(v);const b=flarum.core.compat["common/components/Button"];var V=t.n(b);const k=flarum.core.compat["common/components/LinkButton"];var M=t.n(k);const g=flarum.core.compat["common/components/Select"];var P=t.n(g);const x=flarum.core.compat["common/components/Switch"];var S=t.n(x);function w(t,a){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,a){return t.__proto__=a,t},w(t,a)}const O=((flarum.extensions["flamarkt-backoffice"]||{}).backoffice||{})["components/AbstractList"];var C=function(t){var a,e;function n(){return t.apply(this,arguments)||this}e=t,(a=n).prototype=Object.create(e.prototype),a.prototype.constructor=a,w(a,e);var i=n.prototype;return i.head=function(){var a=t.prototype.head.call(this);return a.add("title",m("th","Title"),20),a.add("price",m("th","Price"),10),a},i.columns=function(a){var e=t.prototype.columns.call(this,a);return e.add("title",m("td",m("input.FormControl",{type:"text",value:a.title(),readonly:!0})),20),e.add("price",m("td",m("input.FormControl",{type:"number",value:a.price(),readonly:!0})),10),e},i.actions=function(a){var e=t.prototype.actions.call(this,a);return e.add("edit",M().component({className:"Button Button--icon",icon:"fas fa-pen",href:r().route.product(a)})),e},n}(t.n(O)()),L={"components/ProductVariantList":C};r().initializers.add("flamarkt-variants",(function(){p().prototype.variantMaster=y().hasOne("variantMaster"),(0,h.extend)(i().prototype,"head",(function(t){t.add("balance",m("th","Variants"))})),(0,h.extend)(i().prototype,"columns",(function(t,a){var e;e=a.attribute("isVariantChild")?"Child":a.attribute("isVariantMaster")?"Yes":"No",t.add("balance",m("td",e))})),(0,h.extend)(l().prototype,"oninit",(function(){this.variantChildrenAttached=!0})),(0,h.extend)(l().prototype,"show",(function(){this.isVariantMaster=this.product.attribute("isVariantMaster"),this.variantProductListState=new(f())({filter:{variantOf:this.product.id()}}),this.product.attribute("isVariantMaster")&&this.variantProductListState.refresh()})),(0,h.extend)(l().prototype,"fields",(function(t){var a=this;if(this.product.attribute("isVariantChild")){var e=this.product.variantMaster();t.add("variant-child-toggle",m(".Form-group",[m("label","Variant Child"),S().component({state:this.variantChildrenAttached,onchange:function(t){a.variantChildrenAttached=t,a.dirty=!0}},"Attached as child"),e?M().component({className:"Button",href:r().route.product(e)},"Edit Master"):null]))}else t.add("variant-master-toggle",m(".Form-group",[m("label","Variant Master"),S().component({state:this.isVariantMaster,onchange:function(t){a.isVariantMaster=t,a.dirty=!0}},"Make into master")]));this.product.attribute("isVariantMaster")&&t.add("variants",m(".Form-group",[m("label","Variants"),m(C,{state:this.variantProductListState}),V().component({onclick:function(){r().store.createRecord("flamarkt-products").save({relationships:{variantMaster:a.product}}).then((function(t){a.variantProductListState.add(t),m.redraw()}))}},"Add"),V().component({onclick:function(){a.variantProductListState.refresh()}},"Refresh")]),-10)})),(0,h.extend)(l().prototype,"data",(function(t){t.isVariantMaster=this.isVariantMaster,this.variantChildrenAttached||(t.relationships=t.relationships||{},t.relationships.variantMaster=null)})),(0,h.extend)(s().prototype,"filters",(function(t){var a=this,e=this.list.params.filter||{};t.add("variants",P().component({value:e.allVariantTypes?"all":e.isVariant?"with":e["-isVariant"]?"without":"default",options:{default:"Variants: default",with:"With variants only",without:"Without variants only",all:"All including children"},onchange:function(t){switch(a.list.params.filter=e,t){case"default":delete a.list.params.filter.isVariant,delete a.list.params.filter["-isVariant"],delete a.list.params.filter.allVariantTypes;break;case"with":a.list.params.filter.isVariant="1",delete a.list.params.filter["-isVariant"],delete a.list.params.filter.allVariantTypes;break;case"without":delete a.list.params.filter.isVariant,a.list.params.filter["-isVariant"]="1",delete a.list.params.filter.allVariantTypes;break;case"all":delete a.list.params.filter.isVariant,delete a.list.params.filter["-isVariant"],a.list.params.filter.allVariantTypes="1"}a.list.refresh()}}),80)}))}))})(),module.exports=a})();
//# sourceMappingURL=backoffice.js.map