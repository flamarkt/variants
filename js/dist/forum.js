(()=>{var t={n:r=>{var e=r&&r.__esModule?()=>r.default:()=>r;return t.d(e,{a:e}),e},d:(r,e)=>{for(var a in e)t.o(e,a)&&!t.o(r,a)&&Object.defineProperty(r,a,{enumerable:!0,get:e[a]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};(()=>{"use strict";t.r(r),t.d(r,{forum:()=>o});const e=flarum.core.compat["forum/app"];var a=t.n(e);const n=flarum.core.compat["common/extend"];var o={};const i=flarum.core.compat["common/components/Select"];var c=t.n(i);const s=((flarum.extensions["flamarkt-core"]||{}).common||{})["models/Product"];var u=t.n(s);const l=((flarum.extensions["flamarkt-core"]||{}).forum||{})["layouts/ProductShowLayout"];var d=t.n(l);const f=((flarum.extensions["flamarkt-core"]||{}).forum||{})["components/ProductListItem"];var p=t.n(f);const v=((flarum.extensions["flamarkt-core"]||{}).common||{})["components/PriceLabel"];var y=t.n(v);const h=flarum.core.compat["common/Model"];var x=t.n(h);a().initializers.add("flamarkt-variants",(function(){u().prototype.variants=x().hasMany("variants"),(0,n.extend)(d().prototype,"oninit",(function(){this.selectedVariantIndex=0})),(0,n.override)(d().prototype,"product",(function(t){var r=this.attrs.product;if(!r||!r.attribute("isVariantMaster"))return t();var e=r.variants(),a=Array.isArray(e)?e.length:0;return this.selectedVariantIndex>a-1?null:e[this.selectedVariantIndex]})),(0,n.extend)(d().prototype,"priceSection",(function(t){var r=this,e=this.attrs.product;if(e.attribute("isVariantMaster")){var a=e.variants();if(Array.isArray(a)){var n={};a.forEach((function(t){n[t.id()]=t.title()})),t.add("variants",c().component({value:a[this.selectedVariantIndex].id(),options:n,onchange:function(t){r.selectedVariantIndex=a.findIndex((function(r){return r.id()===t}))}}),60)}}})),(0,n.extend)(p().prototype,"items",(function(t){var r=this.attrs.product;if(r.attribute("isVariantMaster")){var e=r.variants();if(Array.isArray(e)&&!(e.length<2)){var a=null,n=null;e.forEach((function(t){var r=t.price();r&&((null===a||r<a)&&(a=r),(null===n||r>n)&&(n=r))})),null!==a&&a!==n&&t.replace("price",m("span.ProductListItem--price",[m(y(),{value:a})," - ",m(y(),{value:n})]))}}}))}))})(),module.exports=r})();
//# sourceMappingURL=forum.js.map